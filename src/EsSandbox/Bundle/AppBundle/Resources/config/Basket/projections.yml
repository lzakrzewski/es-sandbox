services:
    #todo: deprecated alias
    es_sandbox.projection.basket: "@es_sandbox.projection.basket.guzzle_eventstore"

    es_sandbox.projector.basket.mysql:
        class: EsSandbox\Basket\Infrastructure\Projection\MysqlBasketProjector
        arguments:
            - "@doctrine.orm.default_entity_manager"
        tags:
            - { name: event_subscriber, subscribes_to: EsSandbox\Basket\Model\BasketWasPickedUp, method: applyBasketWasPickedUp }
            - { name: event_subscriber, subscribes_to: EsSandbox\Basket\Model\ProductWasAddedToBasket, method: applyProductWasAddedToBasket }
            - { name: event_subscriber, subscribes_to: EsSandbox\Basket\Model\ProductWasRemovedFromBasket, method: applyProductWasRemovedFromBasket }

    es_sandbox.projection.basket.mysql:
        class: EsSandbox\Basket\Infrastructure\Projection\MysqlBasketProjection
        arguments:
            - "@doctrine.orm.default_entity_manager"

    es_sandbox.projection.basket.guzzle_eventstore:
        class: EsSandbox\Basket\Infrastructure\Projection\GuzzleEventStoreBasketProjection
        arguments:
            - "@guzzle_http.client"
            - "%es_sandbox.event_store_address%"